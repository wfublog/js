var memberSys=window.memberSys||{};memberSys.blogName="WFU BLOG",memberSys.p={info:"會員資訊",announce:"會員公告",comment:"會員討論區",free:"會員限定文章",value:"會員加值文章",consume:"點數使用明細"},memberSys.t={wait:"請稍待...",waitVerify:"請稍後，正在驗證會員資料...",welcome:"您好，歡迎使用 "+memberSys.blogName+" 會員中心",welcomeNewMember:"您好，歡迎註冊 "+memberSys.blogName+" 會員，成為會員後即可使用會員中心各項功能",loginMember:"請加入 "+memberSys.blogName+" 會員",loginFB:"請先登入 Facebook 來加入/登入會員",newMemberSubmit:"確定資料無誤後，按下「送出資料」按鈕即可完成註冊！",done:"感謝註冊會員資料，您已取得閱覽「會員限定文章」之資格。<p/>"+(memberSys.history?"如您從「會員限定文章」來到此頁面，可按此 <input class='member_button' style='margin-top: 0px;' onclick='location.href=\""+memberSys.history+"\"' value='回到上一頁' type='button'>":""),notDone:"您的資料已送出，但尚未填寫完整！若下次能完整填寫資料，即可進行審核。",updateInfo:"感謝您更新資料",error:"目前伺服器忙碌中，請稍後再試、或重新整理頁面！",name:"姓名",sex:"性別",mail:"信箱",birthday:"生日",phone:"電話",address:"地址",register:"註冊",update:"更新",serial:"編號",defaultMember:"一般會員"},memberSys.u={center:"/p/wfublog-member-center.html",announce:"/p/member-announce.html",comment:"/p/member-comment.html",free:"/p/member-free-post.html",value:"/p/member-value-post.html",consume:"/p/member-point-detail.html",fbComment:"http://www.wfublog.com/2014/01/wfublog-member-center.html"},memberSys.info={},memberSys.json={},memberSys.gif="<img style='vertical-align: middle;' src='https://lh5.googleusercontent.com/-EyVZ0f8J0qQ/UCeEG7aa8nI/AAAAAAAADtY/9sXw53XkYXM/s512/indicator-light.gif'/> ",memberSys.run=memberSys.run||0,$("#member_message").html(memberSys.gif+memberSys.t.waitVerify),memberSys.statusChangeCB=function(e){memberSys.response=e,$("#member_message").html(memberSys.gif+memberSys.t.wait),function(e,m){var r=e.response,t="https://script.google.com/macros/s/AKfycbwHxjIXZrBkujcPpRKj9dopTO5SSQKsXsXA12ADUgbhdW96ryI/exec";function n(r){var t=e.info,n=r.name,o=r.total,s=r.point,i=top.location.href.match(/code\=\w+[^&]/),l;e.json=r,m("#member_total").html("<img src='//3.bp.blogspot.com/-Kn6mIhH8gyM/VEhOi6wlBGI/AAAAAAAAKWM/0fQradHo-qU/h18/member_head.png'/> "+o),s&&a(s),i=i?i[0].split("=")[1]:"",n?(m("#member_message").html(t.name+" "+e.t.welcome),l=i||"info",e.init(l),e.click()):(m("#member_message").html(t.name+" "+e.t.welcomeNewMember),e.showFBinfo())}function a(e){var r="";r+="現有點數 <span class='member_point_value'>"+e+"</span> 點 ",r+="<span id='member_addValue' class='buttonBlue buttonAll'>立即加值 💰</span>",m("#center_point_message").html(r),m("#member_addValue").click(function(){window.open("/2015/01/member-buynow-instruction.html","_blank")})}"connected"===r.status?(memberSys.fbLogout(),FB.api("/me?fields=id,name,email,gender",function(r){e.info=r;var a=r.id;a?(m("#member_icon").attr("src","//graph.facebook.com/"+a+"/picture"),memberSys.run||(memberSys.run=1,m.ajax({type:"GET",data:{method:"queryMember",query:a},url:t,success:function(e){n(JSON.parse(e))},error:function(r){console.log(r),m("#member_message").html(e.t.error)}}))):m("#member_message").html(e.t.error)})):"not_authorized"===r.status?(memberSys.fbJoin(),m("#member_message").html(e.t.loginMember)):(memberSys.fbLogin(),m("#member_message").html(e.t.loginFB))}(memberSys,jQuery)},memberSys.checkLoginState=function(){FB.getLoginStatus(function(e){memberSys.statusChangeCB(e)})},memberSys.scrollTop=function(){var e=$("#member_center").offset().top;$("html, body").animate({scrollTop:e-90},500),$("#member_form").hide()},memberSys.click=function(){$("#member_page_info").click(function(){memberSys.scrollTop(),memberSys.showFBinfo()}),$("#member_page_announce").click(function(){memberSys.scrollTop(),memberSys.announce()}),$("#member_page_comment").click(function(){memberSys.scrollTop(),memberSys.comment()}),$("#member_page_free").click(function(){memberSys.scrollTop(),memberSys.free()}),$("#member_page_value").click(function(){memberSys.scrollTop(),memberSys.value()}),$("#member_page_consume").click(function(){memberSys.scrollTop(),memberSys.consume()})},memberSys.init=function(e){switch(e){case"info":memberSys.showFBinfo();break;case"announce":memberSys.announce();break;case"comment":memberSys.comment();break;case"free":memberSys.free();break;case"value":memberSys.value();break;case"consume":memberSys.consume()}},memberSys.showFBinfo=function(){var e=memberSys,m=e.info,r=e.json,t=m.id,n="",a="",o="",s=r.register&&r.register.substr(0,10),i=r.level,l=r.serial,b=r.name,c=r.sex,u=r.email,d=r.birthday||"",f=r.phone||"",p=r.address||"";$("#member_title").html(e.p.info),$("#member_load").html("<div id='member_left'>"+e.gif+e.t.wait+"</div><div id='memeber_info'></div>"),b?(e.level=i,e.serial=l,e.register=s):(b=m.name,c=m.gender||"",u=m.email||"",o=e.t.newMemberSubmit),n+="<img id='member_avatar' src='//graph.facebook.com/"+t+"/picture'/>",n+="<div>"+b+"</div>",i&&(n+="<div>"+i+"</div>"),l&&(n+="<div>"+e.t.serial+" "+l+"</div>"),s&&(n+="<div>"+e.t.register+" "+s+"</div>"),a+="<div><span>"+e.t.name+"</span>&#12288;<input id='member_name' class='member_input' placeholder='必填' onblur='memberSys.ckName();' maxlength='30' value='"+b+"'/></div>",a+="<div id='member_sex'><span>"+e.t.sex+"</span>&#12288;<label><input type='radio' name='sex' value='1'/>男生</label> <label><input type='radio' name='sex' value='0'/>女生</label></div>",a+="<div><span>"+e.t.mail+"</span>&#12288;<input id='member_email' class='member_input' placeholder='必填' type='email' onblur='memberSys.ckEmail();' maxlength='40' value='"+u+"'/></div>",d&&(a+="<div><span>"+e.t.birthday+"</span>&#12288;<input id='member_birthday' class='member_input' placeholder='選填' type='date' maxlength='15' value='"+d+"'/></div>"),f&&(a+="<div><span>"+e.t.phone+"</span>&#12288;<input id='member_phone' class='member_input' placeholder='選填' type='tel' maxlength='20' value='"+f+"'/></div>"),p&&(a+="<div><span>"+e.t.address+"</span>&#12288;<input id='member_address' class='member_input' placeholder='選填' maxlength='100' value='"+p+"'/></div>"),a+="<input class='member_button' onclick='$(\"#member_done\").html(memberSys.gif + memberSys.t.wait); memberSys.submit(this);' value='送出資料' type='button'/>",a+="<div id='member_done'>"+o+"</div>",$("#member_left").html(n),$("#memeber_info").html(a),"male"!=c&&"男生"!=c||$("#memeber_info input[value=1]").attr("checked",!0),"female"!=c&&"女生"!=c||$("#memeber_info input[value=0]").attr("checked",!0)},memberSys.ckName=function(){var e;if($("#member_name").val().replace(/ /g,""))return $("#member_done").html(""),$("#member_name").css("background-color","#f2f2f2"),!0;$("#member_done").html("請輸入姓名！"),$("#member_name").css("background-color","red")},memberSys.ckEmail=function(){var e=/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z]+$/,m;if(!($("#member_email").val().search(e)<0))return $("#member_done").html(""),$("#member_email").css("background-color","#f2f2f2"),!0;$("#member_done").html("email 格式不正確，請重新輸入！"),$("#member_email").css("background-color","red")},memberSys.ckSex=function(e){if(e)return!0;$("#member_done").html("請選擇性別！")},memberSys.submit=function(disable){var _0xa3f3=["3658ztvTjc","92172LzoMPQ","split","281859CRXwlw","fromCharCode","3631nuaQTQ","16GFUDkT","1GmyCOt","\\w+","1104KYKYBF","37lrQXkU","||val|html|disable|function|level|member_done|memberSys|https|||||||com|||wm|id||||||serial|||||register|case|hostname|error|var|script|google|macros|AKfycbwHxjIXZrBkujcPpRKj9dopTO5SSQKsXsXA12ADUgbhdW96ryI|exec|info|member_name|member_sex|input|checked|member_email|member_birthday|member_phone|member_address|www|facebook|updateMember|addMember|switch|break|defaultMember|ckEmail|ckName|ckSex|gif|wait|disabled|click|ajax|type|POST|data|password|method|name|sex|email|fbUrl|birthday|phone|address|location|url|success|updateInfo|done|console|log|member_message|jQuery","133847RsAffO","replace","14jgHCBM","195235EEqsXJ",'8.4=4,5(e,m){z a=e.4,r="9://A.B.g/C/s/D/E",s="j",l=e.F.k,t=m("#G").2(),o=m("#H I:J").2(),d=m("#K").2(),b=m("#L").2()||"",i=m("#M").2()||"",c=m("#N").2()||"",n=e.6,h=e.q,p=e.v,u="9://O.P.g/"+l,f=p?"Q":"R";S(o){w"0":o="女生";T;w"1":o="男生"}n=n||e.t.U,e.V()&&e.W()&&e.X(o)&&(m("#7").3(e.Y+e.t.Z),m(a)[0].10=!0,e.11(),m.12({13:"14",15:{16:"j",17:f,v:p,6:n,q:h,18:t,19:o,1a:d,k:l,1b:u,1c:b,1d:i,1e:c,x:1f.x},1g:r,1h:5(){e.6?m("#7").3(e.t.1i):m("#7").3(e.t.1j)},y:5(a){1k.1l(a),m("#1m").3(e.t.y)}}))}(8,1n);'],_0x5d74=function(e,m){var r;return _0xa3f3[e-=270]},_0x409a1b=_0x5d74;(function(e,m){for(var r=_0x5d74;;)try{var t;if(106743===-parseInt(r(273))-parseInt(r(270))+parseInt(r(280))*-parseInt(r(281))+parseInt(r(282))*parseInt(r(276))+-parseInt(r(272))*parseInt(r(284))+parseInt(r(275))*parseInt(r(285))+parseInt(r(278)))break;e.push(e.shift())}catch(m){e.push(e.shift())}})(_0xa3f3,106743),eval(function(e,m,r,t,n,a){var o=_0x5d74;if(n=function(e){var m=_0x5d74;return(e<62?"":n(parseInt(e/62)))+((e%=62)>35?String[m(279)](e+29):e.toString(36))},!""[o(271)](/^/,String)){for(;r--;)a[n(r)]=t[r]||n(r);t=[function(e){return a[e]}],n=function(){var e;return o(283)},r=1}for(;r--;)t[r]&&(e=e[o(271)](RegExp("\\b"+n(r)+"\\b","g"),t[r]));return e}(_0x409a1b(274),62,86,_0x409a1b(286)[_0x409a1b(277)]("|"),0,{}))},memberSys.announce=function(){$("#member_load").html(memberSys.gif+memberSys.t.wait),$("#member_title").html(memberSys.p.announce),$("#member_load").load(memberSys.u.announce+" #member_announce")},memberSys.comment=function(){$("#member_load").html(memberSys.gif+memberSys.t.wait),$("#member_title").html(memberSys.p.comment),$("#member_load").load(memberSys.u.comment+" #member_comment",function(){$(".fb-comments").attr({width:.9*$("#member_center").width(),href:memberSys.u.fbComment}),FB.XFBML.parse()})},memberSys.free=function(){$("#member_load").html(memberSys.gif+memberSys.t.wait),$("#member_title").html(memberSys.p.free),function(e,m){var r="https://script.google.com/macros/s/AKfycbwHxjIXZrBkujcPpRKj9dopTO5SSQKsXsXA12ADUgbhdW96ryI/exec";function t(e){var r=e.list,t="<ol>",n,a,o,s;for(n in r)t+="<li><a href='"+(o=(a=r[n]).url)+"' target='_blank'>"+(s=a.title)+"</a></li>";t+="</ol>",m(".member_announce_text").html(t)}m("#member_load").load(e.u.free+" #member_free_post",function(){m.ajax({type:"GET",data:{method:"memberPostList",query:e.json.id},url:r,success:function(e){t(JSON.parse(e))}})})}(memberSys,jQuery)},memberSys.value=function(){$("#member_load").html(memberSys.gif+memberSys.t.wait),$("#member_title").html(memberSys.p.value),function(e,m){m("#member_load").load(e.u.value+" #member_value_post",function(){var r="https://script.google.com/macros/s/AKfycbwHxjIXZrBkujcPpRKj9dopTO5SSQKsXsXA12ADUgbhdW96ryI/exec";function t(r){var t=["BLOGGER","CUSTOM"],a=["Blogger 工具","客製工具"],o=r.list,s=e.json.item,i="",l,b,c,u,d,f,p,y,h;for(l in t){for(b in i+="<h3>"+a[l]+"</h3><br/>",o)u=(c=o[b]).title,d=c.url,f=c.pic,p=c.label,y=c.point,h=c.item,p==t[l]&&(i+="<div class='member_value_item'>",i+="<a href='"+d+"' target='_blank'>",i+="<img src='"+f+"'/>",i+="<div class='value_item_title'>"+u+"</div>",i+="</a>",i+="<p class='center'><span>兌換點數：</span>"+y+" ",s.search(h)<0?i+="<span class='buttonBlue buttonAll center_buyNow' data-label='"+p+"' data-url='"+d+"'>兌換 💰</span>":i+="<span class='buttonRed buttonAll center_buyNow'>已兌換</span>",i+="</p></div>");i+="<br/>"}m(".member_announce_text").html(i),n()}function n(){m(".buttonBlue.center_buyNow").click(function(){var e=m(this),r=e.attr("data-url"),t;"CUSTOM"==e.attr("data-label")?(m("#member_form").show(),alert("此項目需要客製，無法提供現成的程式碼兌換，點數供您報價參考，請用頁面下方的聯絡表單與我聯繫。")):window.open(r,"_blank")})}m.ajax({type:"GET",data:{method:"valuePostList",query:e.json.id},url:r,success:function(e){t(JSON.parse(e))}})})}(memberSys,jQuery)},memberSys.consume=function(){$("#member_load").html(memberSys.gif+memberSys.t.wait),$("#member_title").html(memberSys.p.consume),function(e,m){var r="https://script.google.com/macros/s/AKfycbwHxjIXZrBkujcPpRKj9dopTO5SSQKsXsXA12ADUgbhdW96ryI/exec",t=e.json.item;function n(e){var r=e.list,n=t.split(","),a="",o=[],s=[],i=[],l=0,b,c,u,d,f,p,y;for(b in r)c=r[b],o.push(c.url),s.push(c.title),i.push(c.item);for(b in a+="<ol>",n)n[b]&&(f=n[b].split("-")[0],l+=p=parseInt(n[b].split("-")[1]),a+="<li><a href='"+(u=o[y=i.indexOf(f)])+"' target='_blank'>"+(d=s[y])+"</a> (<span class='red'>"+p+" 點</span>)</li>");a+="</ol>",a+="<div class='center'><span>總共兌換點數：<span class='red'>"+l+"</span> 點</span></div>",m(".member_announce_text").html(a)}m("#member_load").load(e.u.consume+" #member_consume",function(){t?m.ajax({type:"GET",data:{method:"valuePostList",query:e.json.id},url:r,success:function(e){n(JSON.parse(e))}}):m(".member_announce_text").html("<div class='center'><div>沒有兌換記錄</div><div>(\"一般會員\"不保留記錄)</div></div>")})}(memberSys,jQuery)},memberSys.fbLogin=function(){$(".fb_logout, .fb_join").hide(),$(".fb_login").show()},memberSys.fbLogout=function(){$(".fb_login, .fb_join").hide(),$(".fb_logout").show()},memberSys.fbJoin=function(){$(".fb_login, .fb_logout").hide(),$(".fb_join").show()},"undefined"==typeof FB?$.getScript("//connect.facebook.net/zh_TW/sdk.js").done(function(){memberSys.checkLoginState()}):memberSys.checkLoginState(),$(document).on("click",".fb_login, .fb_join",function(){FB.login(function(e){memberSys.statusChangeCB(e)},{scope:"public_profile,email"})}),$(document).on("click",".fb_logout",function(){FB.logout(function(e){location.reload()})});