var memberSys=window.memberSys||{};memberSys.blogName="WFU BLOG",memberSys.p={info:"會員資訊",announce:"會員公告",comment:"會員討論區",free:"會員限定文章",value:"會員加值文章",consume:"點數使用明細",setting:"會員設定"},memberSys.t={wait:"請稍待...",waitVerify:"請稍後，正在驗證會員資料...",welcome:"您好，歡迎使用 "+memberSys.blogName+" 會員中心",welcomeNewMember:"您好，歡迎註冊 "+memberSys.blogName+" 會員，成為會員後即可使用會員中心各項功能",loginMember:"請加入 "+memberSys.blogName+" 會員",loginFB:"請先登入 Facebook 來加入/登入會員",newMemberSubmit:"確定資料無誤後，按下「送出資料」按鈕即可完成註冊！",done:"感謝註冊會員資料，您已取得閱覽「會員限定文章」之資格。<p/>"+(memberSys.history?"如您從「會員限定文章」來到此頁面，可按此 <input class='member_button' style='margin-top: 0px;' onclick='location.href=\""+memberSys.history+"\"' value='回到上一頁' type='button'>":""),notDone:"您的資料已送出，但尚未填寫完整！若下次能完整填寫資料，即可進行審核。",updateInfo:"感謝您更新資料",error:"目前伺服器忙碌中，請稍後再試、或重新整理頁面！",name:"姓名",sex:"性別",mail:"信箱",birthday:"生日",phone:"電話",address:"地址",register:"註冊",update:"更新",serial:"編號",defaultMember:"一般會員"},memberSys.u={center:"/p/wfublog-member-center.html",announce:"/p/member-announce.html",comment:"/p/member-comment.html",free:"/p/member-free-post.html",value:"/p/member-value-post.html",consume:"/p/member-point-detail.html",setting:"/p/member-setting.html",fbComment:"http://www.wfublog.com/2014/01/wfublog-member-center.html"},memberSys.info={},memberSys.json={},memberSys.gif="<img style='vertical-align: middle;' src='https://lh5.googleusercontent.com/-EyVZ0f8J0qQ/UCeEG7aa8nI/AAAAAAAADtY/9sXw53XkYXM/s512/indicator-light.gif'/> ",memberSys.run=memberSys.run||0,$("#member_message").html(memberSys.gif+memberSys.t.waitVerify),memberSys.statusChangeCB=function(e){memberSys.response=e,$("#member_message").html(memberSys.gif+memberSys.t.wait),function(e,m){var t=e.response,r="https://script.google.com/macros/s/AKfycbwHxjIXZrBkujcPpRKj9dopTO5SSQKsXsXA12ADUgbhdW96ryI/exec";function n(t){var r=e.info,n=t.name,s=t.total,a=t.point,i=top.location.href.match(/code=\w+[^&]/),l;e.json=t,m("#member_total").html("<img src='//3.bp.blogspot.com/-Kn6mIhH8gyM/VEhOi6wlBGI/AAAAAAAAKWM/0fQradHo-qU/h18/member_head.png'/> "+s),a&&o(a),i=i?i[0].split("=")[1]:"",n?(m("#member_message").html(r.name+" "+e.t.welcome),l=i||"info",e.init(l),e.click()):(m("#member_message").html(r.name+" "+e.t.welcomeNewMember),e.showFBinfo())}function o(e){var t="";t+="現有點數 <span class='member_point_value'>"+e+"</span> 點 ",t+="<span id='member_addValue' class='buttonBlue buttonAll'>立即加值 💰</span>",m("#center_point_message").html(t),m("#member_addValue").click(function(){window.open("/2015/01/member-buynow-instruction.html","_blank")})}"connected"===t.status?(memberSys.fbLogout(),FB.api("/me?fields=id,name,email,gender",function(t){e.info=t;var o=t.id;o?(m("#member_icon").attr("src","//graph.facebook.com/"+o+"/picture"),memberSys.run||(memberSys.run=1,m.ajax({type:"GET",data:{method:"queryMember",query:o},url:r,success:function(e){n(JSON.parse(e))},error:function(t){console.log(t),m("#member_message").html(e.t.error)}}))):m("#member_message").html(e.t.error)})):"not_authorized"===t.status?(memberSys.fbJoin(),m("#member_message").html(e.t.loginMember)):(memberSys.fbLogin(),m("#member_message").html(e.t.loginFB))}(memberSys,jQuery)},memberSys.checkLoginState=function(){FB.getLoginStatus(function(e){memberSys.statusChangeCB(e)})},memberSys.scrollTop=function(){var e=$("#member_center").offset().top;$("html, body").animate({scrollTop:e-90},500),$("#member_form").hide()},memberSys.click=function(){$("#member_page_info").click(function(){memberSys.scrollTop(),memberSys.showFBinfo()}),$("#member_page_announce").click(function(){memberSys.scrollTop(),memberSys.announce()}),$("#member_page_comment").click(function(){memberSys.scrollTop(),memberSys.comment()}),$("#member_page_free").click(function(){memberSys.scrollTop(),memberSys.free()}),$("#member_page_value").click(function(){memberSys.scrollTop(),memberSys.value()}),$("#member_page_consume").click(function(){memberSys.scrollTop(),memberSys.consume()}),$("#member_page_setting").click(function(){memberSys.scrollTop(),memberSys.setting()})},memberSys.init=function(e){switch(e){case"info":memberSys.showFBinfo();break;case"announce":memberSys.announce();break;case"comment":memberSys.comment();break;case"free":memberSys.free();break;case"value":memberSys.value();break;case"consume":memberSys.consume()}},memberSys.showFBinfo=function(){var e=memberSys,m=e.info,t=e.json,r=m.id,n="",o="",s="",a=t.register&&t.register.substr(0,10),i=t.level,l=t.serial,c=t.name,b=t.sex,u=t.email,d=t.birthday||"",f=t.phone||"",p=t.address||"";$("#member_title").html(e.p.info),$("#member_load").html("<div id='member_left'>"+e.gif+e.t.wait+"</div><div id='memeber_info'></div>"),c?(e.level=i,e.serial=l,e.register=a):(c=m.name,b=m.gender||"",u=m.email||"",s=e.t.newMemberSubmit),n+="<img id='member_avatar' src='//graph.facebook.com/"+r+"/picture'/>",n+="<div>"+c+"</div>",i&&(n+="<div>"+i+"</div>"),l&&(n+="<div>"+e.t.serial+" "+l+"</div>"),a&&(n+="<div>"+e.t.register+" "+a+"</div>"),o+="<div><span>"+e.t.name+"</span>&#12288;<input id='member_name' class='member_input' placeholder='必填' onblur='memberSys.ckName();' maxlength='30' value='"+c+"'/></div>",o+="<div id='member_sex'><span>"+e.t.sex+"</span>&#12288;<label><input type='radio' name='sex' value='1'/>男生</label> <label><input type='radio' name='sex' value='0'/>女生</label></div>",o+="<div><span>"+e.t.mail+"</span>&#12288;<input id='member_email' class='member_input' placeholder='必填' type='email' onblur='memberSys.ckEmail();' maxlength='40' value='"+u+"'/></div>",d&&(o+="<div><span>"+e.t.birthday+"</span>&#12288;<input id='member_birthday' class='member_input' placeholder='選填' type='date' maxlength='15' value='"+d+"'/></div>"),f&&(o+="<div><span>"+e.t.phone+"</span>&#12288;<input id='member_phone' class='member_input' placeholder='選填' type='tel' maxlength='20' value='"+f+"'/></div>"),p&&(o+="<div><span>"+e.t.address+"</span>&#12288;<input id='member_address' class='member_input' placeholder='選填' maxlength='100' value='"+p+"'/></div>"),o+="<input class='member_button' onclick='$(\"#member_done\").html(memberSys.gif + memberSys.t.wait); memberSys.submit(this);' value='送出資料' type='button'/>",o+="<div id='member_done'>"+s+"</div>",$("#member_left").html(n),$("#memeber_info").html(o),"male"!=b&&"男生"!=b||$("#memeber_info input[value=1]").attr("checked",!0),"female"!=b&&"女生"!=b||$("#memeber_info input[value=0]").attr("checked",!0)},memberSys.ckName=function(){var e;if($("#member_name").val().replace(/ /g,""))return $("#member_done").html(""),$("#member_name").css("background-color","#f2f2f2"),!0;$("#member_done").html("請輸入姓名！"),$("#member_name").css("background-color","red")},memberSys.ckEmail=function(){var e=/^\w+((-\w+)|(\.\w+))*@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z]+$/,m;if(!($("#member_email").val().search(e)<0))return $("#member_done").html(""),$("#member_email").css("background-color","#f2f2f2"),!0;$("#member_done").html("email 格式不正確，請重新輸入！"),$("#member_email").css("background-color","red")},memberSys.ckSex=function(e){if(e)return!0;$("#member_done").html("請選擇性別！")},memberSys.submit=function(disable){function _0x5c5c(e,m){var t=_0x361c();return(_0x5c5c=function(e,m){var r;return t[e-=270]})(e,m)}var _0x23f135=_0x5c5c;function _0x361c(){var e=["354840rQXkUC","355292tvTjcl","252zoMPQj","102YKYBFz","3201kOjSah","2063270xGJPax","toString","replace","34uaQTQG","||val|html|disable|function|level|member_done|memberSys|https|||||||com|||wm|id||||||serial|||||register|case|hostname|error|var|script|google|macros|AKfycbwHxjIXZrBkujcPpRKj9dopTO5SSQKsXsXA12ADUgbhdW96ryI|exec|info|member_name|member_sex|input|checked|member_email|member_birthday|member_phone|member_address|www|facebook|updateMember|addMember|switch|break|defaultMember|ckEmail|ckName|ckSex|gif|wait|disabled|click|ajax|type|POST|data|password|method|name|sex|email|fbUrl|birthday|phone|address|location|url|success|updateInfo|done|console|log|member_message|jQuery","916FUDkTG","45RXwlwY","73665gHCBMK","584067myCOtL","fromCharCode","split","43068ItVlDF"];return(_0x361c=function(){return e})()}(function(e,m){for(var t=_0x5c5c,r=e();;)try{var n;if(552067===-parseInt(t(283))/1*(-parseInt(t(285))/2)+-parseInt(t(271))/3+parseInt(t(277))/4*(parseInt(t(270))/5)+-parseInt(t(278))/6*(-parseInt(t(276))/7)+-parseInt(t(275))/8*(parseInt(t(286))/9)+parseInt(t(280))/10+-parseInt(t(279))/11*(parseInt(t(274))/12))break;r.push(r.shift())}catch(e){r.push(r.shift())}})(_0x361c,552067),eval(function(e,m,t,r,n,o){var s=_0x5c5c;if(n=function(e){var m=_0x5c5c;return(e<62?"":n(parseInt(e/62)))+((e%=62)>35?String[m(272)](e+29):e[m(281)](36))},!""[s(282)](/^/,String)){for(;t--;)o[n(t)]=r[t]||n(t);r=[function(e){return o[e]}],n=function(){return"\\w+"},t=1}for(;t--;)r[t]&&(e=e[s(282)](RegExp("\\b"+n(t)+"\\b","g"),r[t]));return e}('8.4=4,5(e,m){z a=e.4,r="9://A.B.g/C/s/D/E",s="j",l=e.F.k,t=m("#G").2(),o=m("#H I:J").2(),d=m("#K").2(),b=m("#L").2()||"",i=m("#M").2()||"",c=m("#N").2()||"",n=e.6,h=e.q,p=e.v,u="9://O.P.g/"+l,f=p?"Q":"R";S(o){w"0":o="女生";T;w"1":o="男生"}n=n||e.t.U,e.V()&&e.W()&&e.X(o)&&(m("#7").3(e.Y+e.t.Z),m(a)[0].10=!0,e.11(),m.12({13:"14",15:{16:"j",17:f,v:p,6:n,q:h,18:t,19:o,1a:d,k:l,1b:u,1c:b,1d:i,1e:c,x:1f.x},1g:r,1h:5(){e.6?m("#7").3(e.t.1i):m("#7").3(e.t.1j)},y:5(a){1k.1l(a),m("#1m").3(e.t.y)}}))}(8,1n);',62,86,_0x23f135(284)[_0x23f135(273)]("|"),0,{}))},memberSys.announce=function(){$("#member_load").html(memberSys.gif+memberSys.t.wait),$("#member_title").html(memberSys.p.announce),$("#member_load").load(memberSys.u.announce+" #member_announce")},memberSys.comment=function(){$("#member_load").html(memberSys.gif+memberSys.t.wait),$("#member_title").html(memberSys.p.comment),$("#member_load").load(memberSys.u.comment+" #member_comment",function(){$(".fb-comments").attr({width:.9*$("#member_center").width(),href:memberSys.u.fbComment}),FB.XFBML.parse()})},memberSys.free=function(){$("#member_load").html(memberSys.gif+memberSys.t.wait),$("#member_title").html(memberSys.p.free),function(e,m){var t="https://script.google.com/macros/s/AKfycbwHxjIXZrBkujcPpRKj9dopTO5SSQKsXsXA12ADUgbhdW96ryI/exec";function r(e){var t=e.list,r="<ol>",n,o,s,a;for(n in t)r+="<li><a href='"+(s=(o=t[n]).url)+"' target='_blank'>"+(a=o.title)+"</a></li>";r+="</ol>",m(".member_announce_text").html(r)}m("#member_load").load(e.u.free+" #member_free_post",function(){m.ajax({type:"GET",data:{method:"memberPostList",query:e.json.id},url:t,success:function(e){r(JSON.parse(e))}})})}(memberSys,jQuery)},memberSys.value=function(){$("#member_load").html(memberSys.gif+memberSys.t.wait),$("#member_title").html(memberSys.p.value),function(e,m){m("#member_load").load(e.u.value+" #member_value_post",function(){var t="https://script.google.com/macros/s/AKfycbwHxjIXZrBkujcPpRKj9dopTO5SSQKsXsXA12ADUgbhdW96ryI/exec";function r(t){var r=["BLOGGER","CUSTOM"],o=["Blogger 工具","客製工具"],s=t.list,a=e.json.item,i="",l,c,b,u,d,f,p,y,_;for(l in r){for(c in i+="<h3>"+o[l]+"</h3><br/>",s)u=(b=s[c]).title,d=b.url,f=b.pic,p=b.label,y=b.point,_=b.item,p==r[l]&&(i+="<div class='member_value_item'>",i+="<a href='"+d+"' target='_blank'>",i+="<img src='"+f+"'/>",i+="<div class='value_item_title'>"+u+"</div>",i+="</a>",i+="<p class='center'><span>兌換點數：</span>"+y+" ",a.search(_)<0?i+="<span class='buttonBlue buttonAll center_buyNow' data-label='"+p+"' data-url='"+d+"'>兌換 💰</span>":i+="<span class='buttonRed buttonAll center_buyNow'>已兌換</span>",i+="</p></div>");i+="<br/>"}m(".member_announce_text").html(i),n()}function n(){m(".buttonBlue.center_buyNow").click(function(){var e=m(this),t=e.attr("data-url"),r;"CUSTOM"==e.attr("data-label")?(m("#member_form").show(),alert("此項目需要客製，無法提供現成的程式碼兌換，點數供您報價參考，請用頁面下方的聯絡表單與我聯繫。")):window.open(t,"_blank")})}m.ajax({type:"GET",data:{method:"valuePostList",query:e.json.id},url:t,success:function(e){r(JSON.parse(e))}})})}(memberSys,jQuery)},memberSys.consume=function(){$("#member_load").html(memberSys.gif+memberSys.t.wait),$("#member_title").html(memberSys.p.consume),function(e,m){var t="https://script.google.com/macros/s/AKfycbwHxjIXZrBkujcPpRKj9dopTO5SSQKsXsXA12ADUgbhdW96ryI/exec",r=e.json.item;function n(e){var t=e.list,n=r.split(","),o="",s=[],a=[],i=[],l=0,c,b,u,d,f,p,y;for(c in t)b=t[c],s.push(b.url),a.push(b.title),i.push(b.item);for(c in o+="<ol>",n)n[c]&&(f=n[c].split("-")[0],l+=p=parseInt(n[c].split("-")[1]),o+="<li><a href='"+(u=s[y=i.indexOf(f)])+"' target='_blank'>"+(d=a[y])+"</a> (<span class='red'>"+p+" 點</span>)</li>");o+="</ol>",o+="<div class='center'><span>總共兌換點數：<span class='red'>"+l+"</span> 點</span></div>",m(".member_announce_text").html(o)}m("#member_load").load(e.u.consume+" #member_consume",function(){r?m.ajax({type:"GET",data:{method:"valuePostList",query:e.json.id},url:t,success:function(e){n(JSON.parse(e))}}):m(".member_announce_text").html("<div class='center'><div>沒有兌換記錄</div><div>(\"一般會員\"不保留記錄)</div></div>")})}(memberSys,jQuery)},memberSys.setting=function(){$("#member_load").html(memberSys.gif+memberSys.t.wait),$("#member_title").html(memberSys.p.setting),$("#member_load").load(memberSys.u.setting+" #member_setting",function(){$(".deleteAccount").click(function(){var e;confirm("確定要刪除帳號?")&&FB.logout(function(){location.href="/"})})})},memberSys.fbLogin=function(){$(".fb_logout, .fb_join").hide(),$(".fb_login").show()},memberSys.fbLogout=function(){$(".fb_login, .fb_join").hide(),$(".fb_logout").show()},memberSys.fbJoin=function(){$(".fb_login, .fb_logout").hide(),$(".fb_join").show()},"undefined"==typeof FB?$.getScript("//connect.facebook.net/zh_TW/sdk.js").done(function(){memberSys.checkLoginState()}):memberSys.checkLoginState(),$(document).on("click",".fb_login, .fb_join",function(){FB.login(function(e){memberSys.statusChangeCB(e)},{scope:"public_profile,email"})}),$(document).on("click",".fb_logout",function(){FB.logout(function(){location.reload()})});